import{Q as p}from"./QBtn.3d258e44.js";import{Q as q,b as A,a as y,c as N,d as j}from"./QTable.7493f404.js";import{Q as h}from"./Ripple.38fc6791.js";import{Q as D,a as F}from"./QForm.e99f2504.js";import{Q as T,a as B,C as U}from"./ClosePopup.dd53f34a.js";import{Q as L}from"./QCardActions.92a61019.js";import{Q as P}from"./QCard.365d5074.js";import{i as E,ay as R,a1 as $,r as M,O as v,ao as _,ae as g,j as V,k as O,m as l,d as o,l as s,F as G,n as x,ab as f,ac as K,p as d,z as H,q as J,a3 as W,a4 as X}from"./index.3ee45ed8.js";import"./render.e84c070c.js";import"./use-dark.5e48430f.js";import"./scroll.edd63a8d.js";import"./use-key-composition.205d99e1.js";import"./uid.42677368.js";import"./use-fullscreen.091d5924.js";function Y(){return E(R)}const Q=u=>(W("data-v-6cdb6195"),u=u(),X(),u),Z={id:"admin-news"},ee=Q(()=>l("h3",{class:"title"},"Article Management",-1)),te={class:"row"},ae={class:"col-10"},oe={class:"col-10"},ie=["src"],se={class:"text-center title"},le={class:"row"},ne={class:"col-12"},de={class:"col-12"},re={class:"q-pa-md q-gutter-sm"},ce={class:"col-12"},me={class:"col-12"},ue={class:"col-12"},pe=Q(()=>l("div",{class:"col-12"},null,-1)),ge={__name:"NewsView",setup(u){const S=M(!0),C=[{name:"name",label:"Article Title",field:t=>t.name,align:"center"},{name:"category",label:"Category",field:t=>t.category,align:"center"},{name:"image",label:"Image",field:t=>t,align:"center"},{name:"date",label:"Post Date",field:t=>new Date(t.date).toLocaleDateString(),align:"center"},{name:"edit",label:"Edit",field:t=>t,align:"center"}],n=Y(),k=["News","Featured Articles","Oters"],b={required(t){return!!t||"\u6B04\u4F4D\u5FC5\u586B"}},r=v([]),e=v({_id:"",name:"",description:"",image:void 0,post:!1,category:"",loading:!1,dialog:!1,idx:-1}),w=t=>{t===-1?(e._id="",e.name="",e.description="",e.image=void 0,e.post=!1,e.category="",e.loading=!1,e.idx=-1):(e._id=r[t]._id,e.name=r[t].name,e.description=r[t].description,e.image=void 0,e.post=r[t].post,e.category=r[t].category,e.loading=!1,e.idx=t),e.dialog=!0},z=async()=>{var a,c;e.loading=!0;const t=new FormData;t.append("name",e.name),t.append("image",e.image),t.append("description",e.description),t.append("post",e.post),t.append("category",e.category);try{if(e._id.length===0){const{data:m}=await _.post("/news",t);r.push(m.result),g.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:m}=await _.patch("/news/"+e._id,t);r[e.idx]=m.result,g.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(m){g.fire({icon:"error",title:"\u5931\u6557",text:((c=(a=m==null?void 0:m.response)==null?void 0:a.data)==null?void 0:c.message)||"\u767C\u751F\u932F\u8AA4"})}e.loading=!1};return(async()=>{var t,a;try{const{data:c}=await _.get("/news/all");r.push(...c.result)}catch(c){g.fire({icon:"error",title:"\u5931\u6557",text:((a=(t=c==null?void 0:c.response)==null?void 0:t.data)==null?void 0:a.message)||"\u767C\u751F\u932F\u8AA4"})}})(),(t,a)=>{const c=x("q-card-title"),m=x("q-card-text");return V(),O(G,null,[l("div",Z,[ee,l("div",te,[l("div",ae,[o(p,{color:"primary",onClick:a[0]||(a[0]=i=>w(-1))},{default:s(()=>[f("Add Article")]),_:1})]),l("div",oe,[o(q,{rows:r,columns:C,"row-key":"_id"},{"body-cell-image":s(i=>[o(y,{class:"slot"},{default:s(()=>[l("img",{src:i.row.image,style:{height:"100px",width:"170px"}},null,8,ie)]),_:2},1024)]),"body-cell-edit":s(i=>[o(y,{class:"slot"},{default:s(()=>[o(p,{round:"round",onClick:_e=>w(r.findIndex(I=>I._id===i.row._id))},{default:s(()=>[o(h,{name:"build"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["rows"])])])]),o(A,{modelValue:e.dialog,"onUpdate:modelValue":a[6]||(a[6]=i=>e.dialog=i),persistent:"",maximized:S.value,"transition-show":"slide-up","transition-hide":"slide-down"},{default:s(()=>[o(P,{class:"dialog-card"},{default:s(()=>[o(D,{onSubmit:z},{default:s(()=>[o(c,null,{default:s(()=>[l("h4",se,K(e._id.length>0?"Edit Article":"Post Article"),1)]),_:1}),o(m,null,{default:s(()=>[l("div",le,[l("div",ne,[o(F,{modelValue:e.name,"onUpdate:modelValue":a[1]||(a[1]=i=>e.name=i),type:"text",label:"Title",rules:[b.required]},null,8,["modelValue","rules"])]),l("div",de,[l("div",re,[o(T,{modelValue:e.description,"onUpdate:modelValue":a[2]||(a[2]=i=>e.description=i),dense:d(n).screen.lt.md,toolbar:[[{label:d(n).lang.editor.align,icon:d(n).iconSet.editor.align,fixedLabel:!0,list:"only-icons",options:["left","center","right","justify"]},{label:d(n).lang.editor.align,icon:d(n).iconSet.editor.align,fixedLabel:!0,options:["left","center","right","justify"]}],["bold","italic","strike","underline","subscript","superscript"],["token","hr","link","custom_btn"],["print","fullscreen"],[{label:d(n).lang.editor.formatting,icon:d(n).iconSet.editor.formatting,list:"no-icons",options:["p","h1","h2","h3","h4","h5","h6","code"]},{label:d(n).lang.editor.fontSize,icon:d(n).iconSet.editor.fontSize,fixedLabel:!0,fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},{label:d(n).lang.editor.defaultFont,icon:d(n).iconSet.editor.font,fixedIcon:!0,list:"no-icons",options:["default_font","arial","arial_black","comic_sans","courier_new","impact","lucida_grande","times_new_roman","verdana"]},"removeFormat"],["quote","unordered","ordered","outdent","indent"],["undo","redo"],["viewsource"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"}},null,8,["modelValue","dense","toolbar"])])]),l("div",ce,[o(N,{modelValue:e.category,"onUpdate:modelValue":a[3]||(a[3]=i=>e.category=i),options:k,rules:[b.required],label:"Category"},null,8,["modelValue","rules"])]),l("div",me,[o(B,{modelValue:e.image,"onUpdate:modelValue":a[4]||(a[4]=i=>e.image=i),label:"Pick Images",filled:"",append:"",accept:".jpg, image/*",onRejected:t.onRejected},{prepend:s(()=>[o(h,{name:"image"})]),_:1},8,["modelValue","onRejected"])]),l("div",ue,[o(j,{modelValue:e.post,"onUpdate:modelValue":a[5]||(a[5]=i=>e.post=i),label:"Post"},null,8,["modelValue"])]),pe])]),_:1}),o(L,null,{default:s(()=>[H((V(),J(p,{disabled:e.loading},{default:s(()=>[f("Cancel")]),_:1},8,["disabled"])),[[U]]),o(p,{disabled:e.loading,color:"primary",type:"submit"},{default:s(()=>[f("Submit")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","maximized"])],64)}}};var qe=$(ge,[["__scopeId","data-v-6cdb6195"]]);export{qe as default};
