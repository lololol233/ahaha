import{Q as p}from"./QBtn.176a8bd8.js";import{Q as q,b as z,a as y,c as N,d as j}from"./QTable.e8a003cd.js";import{Q as h}from"./Ripple.864aff7b.js";import{Q as A,a as D}from"./QForm.f82c6a1b.js";import{Q as F,a as B,C as T}from"./ClosePopup.e1629ed9.js";import{Q as U}from"./QCardActions.6397317d.js";import{Q as L}from"./QCard.5a8958ef.js";import{i as P,ay as R,a0 as E,N as v,ao as g,ae as _,j as V,a1 as $,q as s,d as o,l,F as M,m as Q,ab as f,ac as G,n as d,y as K,k as H,a3 as J,a4 as O}from"./index.8fa2858c.js";import"./render.6b9ad025.js";import"./use-dark.6b4e8ee5.js";import"./scroll.3c4a2864.js";import"./use-key-composition.627013dd.js";import"./uid.42677368.js";import"./use-fullscreen.c99a7788.js";function W(){return P(R)}const x=m=>(J("data-v-45842163"),m=m(),O(),m),X={id:"admin-news"},Y=x(()=>s("h2",{class:"title"},"Article Management",-1)),Z={class:"row"},ee={class:"col-12"},te={class:"col-10"},ae=["src"],oe={class:"text-center"},ie={class:"row"},le={class:"col-12"},se={class:"col-12"},ne={class:"q-pa-md q-gutter-sm"},de={class:"col-12"},re={class:"col-12"},ce={class:"col-12"},ue=x(()=>s("div",{class:"col-12"},null,-1)),me={__name:"NewsView",setup(m){const S=[{name:"name",label:"Article Title",field:t=>t.name,align:"center"},{name:"image",label:"Image",field:t=>t,align:"center"},{name:"date",label:"Post Date",field:t=>new Date(t.date).toLocaleDateString(),align:"center"},{name:"edit",label:"Edit",field:t=>t,align:"center"}],n=W(),k=["\u6700\u65B0\u6D88\u606F","\u7CBE\u91C7\u6587\u7AE0","\u5176\u4ED6"],b={required(t){return!!t||"\u6B04\u4F4D\u5FC5\u586B"}},r=v([]),e=v({_id:"",name:"",description:"",image:void 0,post:!1,category:"",loading:!1,dialog:!1,idx:-1}),w=t=>{t===-1?(e._id="",e.name="",e.description="",e.image=void 0,e.post=!1,e.category="",e.loading=!1,e.idx=-1):(e._id=r[t]._id,e.name=r[t].name,e.description=r[t].description,e.image=void 0,e.post=r[t].post,e.category=r[t].category,e.loading=!1,e.idx=t),e.dialog=!0},C=async()=>{var a,c;e.loading=!0;const t=new FormData;t.append("name",e.name),t.append("image",e.image),t.append("description",e.description),t.append("post",e.post),t.append("category",e.category);try{if(e._id.length===0){const{data:u}=await g.post("/news",t);r.push(u.result),_.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:u}=await g.patch("/news/"+e._id,t);r[e.idx]=u.result,_.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(u){_.fire({icon:"error",title:"\u5931\u6557",text:((c=(a=u==null?void 0:u.response)==null?void 0:a.data)==null?void 0:c.message)||"\u767C\u751F\u932F\u8AA4"})}e.loading=!1};return(async()=>{var t,a;try{const{data:c}=await g.get("/news/all");r.push(...c.result)}catch(c){_.fire({icon:"error",title:"\u5931\u6557",text:((a=(t=c==null?void 0:c.response)==null?void 0:t.data)==null?void 0:a.message)||"\u767C\u751F\u932F\u8AA4"})}})(),(t,a)=>{const c=Q("q-card-title"),u=Q("q-card-text");return V(),$(M,null,[s("div",X,[Y,s("div",Z,[s("div",ee,[o(p,{color:"primary",onClick:a[0]||(a[0]=i=>w(-1))},{default:l(()=>[f("Add Article")]),_:1})]),s("div",te,[o(q,{rows:r,columns:S,"row-key":"_id"},{"body-cell-image":l(i=>[o(y,null,{default:l(()=>[s("img",{src:i.row.image,style:{height:"100px",width:"100px"}},null,8,ae)]),_:2},1024)]),"body-cell-edit":l(i=>[o(y,null,{default:l(()=>[o(p,{round:"round",onClick:pe=>w(r.findIndex(I=>I._id===i.row._id))},{default:l(()=>[o(h,{name:"build"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["rows"])])])]),o(z,{modelValue:e.dialog,"onUpdate:modelValue":a[6]||(a[6]=i=>e.dialog=i),persistent:""},{default:l(()=>[o(L,null,{default:l(()=>[o(A,{onSubmit:C},{default:l(()=>[o(c,null,{default:l(()=>[s("h3",oe,G(e._id.length>0?"\u7DE8\u8F2F\u6587\u7AE0":"\u65B0\u589E\u6587\u7AE0"),1)]),_:1}),o(u,null,{default:l(()=>[s("div",ie,[s("div",le,[o(D,{modelValue:e.name,"onUpdate:modelValue":a[1]||(a[1]=i=>e.name=i),type:"text",label:"Title",rules:[b.required]},null,8,["modelValue","rules"])]),s("div",se,[s("div",ne,[o(F,{modelValue:e.description,"onUpdate:modelValue":a[2]||(a[2]=i=>e.description=i),dense:d(n).screen.lt.md,toolbar:[[{label:d(n).lang.editor.align,icon:d(n).iconSet.editor.align,fixedLabel:!0,list:"only-icons",options:["left","center","right","justify"]},{label:d(n).lang.editor.align,icon:d(n).iconSet.editor.align,fixedLabel:!0,options:["left","center","right","justify"]}],["bold","italic","strike","underline","subscript","superscript"],["token","hr","link","custom_btn"],["print","fullscreen"],[{label:d(n).lang.editor.formatting,icon:d(n).iconSet.editor.formatting,list:"no-icons",options:["p","h1","h2","h3","h4","h5","h6","code"]},{label:d(n).lang.editor.fontSize,icon:d(n).iconSet.editor.fontSize,fixedLabel:!0,fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},{label:d(n).lang.editor.defaultFont,icon:d(n).iconSet.editor.font,fixedIcon:!0,list:"no-icons",options:["default_font","arial","arial_black","comic_sans","courier_new","impact","lucida_grande","times_new_roman","verdana"]},"removeFormat"],["quote","unordered","ordered","outdent","indent"],["undo","redo"],["viewsource"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"}},null,8,["modelValue","dense","toolbar"])])]),s("div",de,[o(N,{modelValue:e.category,"onUpdate:modelValue":a[3]||(a[3]=i=>e.category=i),options:k,rules:[b.required],label:"\u5206\u985E"},null,8,["modelValue","rules"])]),s("div",re,[o(B,{modelValue:e.image,"onUpdate:modelValue":a[4]||(a[4]=i=>e.image=i),label:"Pick Images",filled:"",append:"",accept:".jpg, image/*",onRejected:t.onRejected},{prepend:l(()=>[o(h,{name:"image"})]),_:1},8,["modelValue","onRejected"])]),s("div",ce,[o(j,{modelValue:e.post,"onUpdate:modelValue":a[5]||(a[5]=i=>e.post=i),label:"Post"},null,8,["modelValue"])]),ue])]),_:1}),o(U,null,{default:l(()=>[K((V(),H(p,{disabled:e.loading,color:"primary"},{default:l(()=>[f("Cancel")]),_:1},8,["disabled"])),[[T]]),o(p,{disabled:e.loading,color:"primary",type:"submit"},{default:l(()=>[f("Submit")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}};var Ie=E(me,[["__scopeId","data-v-45842163"]]);export{Ie as default};
